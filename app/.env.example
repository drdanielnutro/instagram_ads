# Runtime mode: Vertex AI (no API key)
GOOGLE_GENAI_USE_VERTEXAI=True
GOOGLE_CLOUD_PROJECT=instagram-ads-472021
GOOGLE_CLOUD_LOCATION=us-central1
# Local dev only; don't set this in Cloud Run
GOOGLE_APPLICATION_CREDENTIALS=./sa-key.json

# CORS
ALLOW_ORIGINS=*

# Artifacts / logs bucket (GCS)
ARTIFACTS_BUCKET=gs://instagram-ads-472021-facilitador-logs-data
ARTIFACTS_BUCKET_LOCATION=us-central1

# Deliveries / signed URLs
DELIVERIES_BUCKET=gs://instagram-ads-472021-deliveries

# Reference images bucket (for image uploads)
REFERENCE_IMAGES_BUCKET=gs://instagram-ads-472021-reference-images


# If false, buckets must exist beforehand
ENABLE_AUTO_BUCKET_CREATE=false

# Flags de funcionalidades
ENABLE_IMAGE_GENERATION=true

# Flags para novos campos de entrada (desenvolvimento local)
# Shadow mode: true = extrai e loga sem incluir no initial_state
PREFLIGHT_SHADOW_MODE=true
# Novos campos: false = não inclui no initial_state (seguro para testes)
ENABLE_NEW_INPUT_FIELDS=true
# Habilita fallback se o StoryBrand for considerado fraco. True = usa fallback, false = não usa fallback
ENABLE_STORYBRAND_FALLBACK=true

# Força o fallback do StoryBrand (para testes). Em produção, deve ser false
STORYBRAND_GATE_DEBUG=true

# Tracing
TRACING_DISABLE_GCS=true

# --- Vertex AI Performance Tuning ---

# Concurrency limit for simultaneous requests to Vertex AI
VERTEX_CONCURRENCY_LIMIT=1

# Exponential backoff settings for retrying failed Vertex AI requests
VERTEX_RETRY_MAX_ATTEMPTS=5
VERTEX_RETRY_INITIAL_BACKOFF=1.0
VERTEX_RETRY_MAX_BACKOFF=30.0
VERTEX_RETRY_BACKOFF_MULTIPLIER=2.0
VERTEX_RETRY_JITTER=1.5

# --- StoryBrand Analysis Tuning ---

# Adaptive truncation for large HTML inputs to avoid token limits
STORYBRAND_HARD_CHAR_LIMIT=20000
STORYBRAND_SOFT_CHAR_LIMIT=12000
STORYBRAND_TAIL_RATIO=0.2

# Optional local caching for StoryBrand analysis results
STORYBRAND_CACHE_ENABLED=true
STORYBRAND_CACHE_MAXSIZE=32
STORYBRAND_CACHE_TTL=900

# Notes:
# - Do NOT set GOOGLE_API_KEY when using Vertex AI.
# - Ensure project APIs are enabled: aiplatform, storage, logging.
# - Create the bucket once in the target region, e.g.:
#   gcloud storage buckets create gs://instagram-ads-472021-facilitador-logs-data \
#     --project=instagram-ads-472021 --location=us-central1 --uniform-bucket-level-access


# Controle do pipeline determinístico do JSON final; deixe em false até concluir implementação e testes
ENABLE_DETERMINISTIC_FINAL_VALIDATION=true

# Habilita persistência das seções do StoryBrand no Firestore (para análise posterior)
PERSIST_STORYBRAND_SECTIONS=true

# Habilita imagens de referência para geração de imagens (para testes)
ENABLE_REFERENCE_IMAGES=true